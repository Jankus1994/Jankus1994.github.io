<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin - Domination Game</title>
<link rel="stylesheet" href="style.css">
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
</head>
<body>
<div class="container">
  <h1>Admin - Domination Game</h1>
  <div>
    <button class="start" onclick="startGame()">Spustit hru</button>
    <button class="stop" onclick="stopGame()">Zastavit hru</button>
    <button class="reset" onclick="resetGame()">Resetovat hru</button>
  </div>
  <div id="gameStatus">Načítám…</div>

  <label for="divider">Divider (bod každou sekundu / divider):
    <input type="number" id="divider" value="1" min="1">
    <button onclick="updateDivider()">Uložit</button>
  </label>
</div>

<script>
const firebaseConfig = {
      apiKey: "AIzaSyDOEonHWXYZU5bYuETpI_6bk7oIVyHQP1Q",
      authDomain: "domination-game-c1426.firebaseapp.com",
      projectId: "domination-game-c1426",
      storageBucket: "domination-game-c1426.firebasestorage.app",
      messagingSenderId: "630646319",
      appId: "1:630646319:web:8ef916ac9c10ca071a48da"  
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

const statusEl = document.getElementById("gameStatus");
db.collection("game").doc("state").onSnapshot(doc=>{
  if(doc.exists){ statusEl.textContent = doc.data().status; } 
  else { statusEl.textContent="stopped"; }
});

function startGame(){ db.collection("game").doc("state").set({ status:"running" },{merge:true}); }
function stopGame(){ db.collection("game").doc("state").set({ status:"stopped" },{merge:true}); }

function resetGame(){
  db.collection("scores").doc("teams").set({ A:0,B:0 });
  db.collection("locations").get().then(snap=>{
    snap.forEach(doc=> db.collection("locations").doc(doc.id).set({ owner:"neutral" },{merge:true}));
  });
  db.collection("game").doc("state").set({ status:"stopped", divider:1 },{merge:true});
}

function updateDivider(){
  const divider = parseInt(document.getElementById("divider").value)||1;
  db.collection("game").doc("state").set({ divider:divider },{merge:true});
}
</script>
</body>
</html>
